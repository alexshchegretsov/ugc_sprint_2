### Запуск и первоначальная настройка

- `make run` - запуск кластера MongoDB
- `make stop` - остановка кластера MongoDB
- `make init_cluster` - инициализация кластера и БД
- `make seed_db` - заполнение БД тестовыми данными
- `make run_benchmarks` - запуск тестов производительности

### Структура данных

БД разделена на следующие коллекции:

- **movies**
    - схема данных:
    
            {
                "_id": <uuid_string>,
                "ratings_qty": <integer>,
                "ratings_sum": <integer>,
                "reviews": [<uuid_string>, ...]
            }
    - не шардируется

- **users**
    - схема данных:
    
            {
                "_id": <uuid_string>,
                "bookmarks": [<uuid_string>, ...]
            }    
    - ключ шардирования: **_id**
    
- **movie_ratings**
    - схема данных:
    
            {
                "_id": <uuid_string>,
                "movie_id": <uuid_string>,
                "user_id": <uuid_string>,
                "score": <integer>
            }  
    - ключ шардирования: **user_id**
            
- **reviews**
    - схема данных:
    
            {
                "_id": <uuid_string>,
                "author_id": <uuid_string>,
                "movie_id": <uuid_string>,
                "text": <string>,
                "pub_date": <datetime>,
                "movie_rating_id": <uuid_string>,
                "movie_rating_score": <integer>,
                "review_rating_sum": <integer>,
                "review_rating_qty": <integer>,
            }
    - ключ шардирования: **author_id**

### Требования

- количество пользователей: 500_000
- количество фильмов: 20_000
- максимальное время ответа БД: 200мс

### Результаты тестирования

#### Операции чтения

| сценарий использования                              | среднее время выполнения, с |
|-----------------------------------------------------|-----------------------------|
| получение отсортированного списка рецензий к фильму | 0.0014                      |
| получение списка понравившихся пользователю фильмов | 0.0011                      |
| получение количества оценок фильма                  | 0.0008                      |
| получение колтчества положительных оценок фильма    | 0.0015                      |
| получение средней оценки фильма                     | 0.0008                      |

#### Операции записи

| сценарий использования           | среднее время выполнения, с |
|----------------------------------|-----------------------------|
| добавление оценки к фильму       | 0.0025                      |
| добавление рецензии к фильму     | 0.0040                      |
| добавление закладки пользователю | 0.0008                      |


### Выводы

**MongoDB** подходит для хранения пользовательских данных (оценки и рецензии к фильмам),
 т.к. с большим запасом удовлетворяет требуемым показателям производительности.